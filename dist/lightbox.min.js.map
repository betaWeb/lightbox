{"version":3,"sources":["src/utils.ts","src/Lightbox.ts","index.js"],"names":["globalThis","Lightbox"],"mappings":"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","file":"lightbox.min.js","sourceRoot":"..","sourcesContent":["export function debounce(callback: Function, delay: number): Function {\r\n    let timer;\r\n\r\n    return function() {\r\n        let args = arguments\r\n        let context = this\r\n\r\n        clearTimeout(timer)\r\n\r\n        timer = setTimeout(() => {\r\n            callback.apply(context, args)\r\n        }, delay)\r\n    }\r\n}","import { debounce } from \"./utils\";\r\n\r\nexport default class Lightbox<T> {\r\n\r\n\tpublic elements: NodeList\r\n\r\n\tpublic options: Options\r\n\r\n\tprivate _groups: Groups = {}\r\n\r\n\tprivate _lightbox: HTMLDivElement = null\r\n\r\n\tprivate _lightbox_inner: HTMLDivElement = null\r\n\r\n\tprivate _image: HTMLImageElement = null\r\n\r\n\tprivate _nav_prev: HTMLDivElement = null\r\n\r\n\tprivate _nav_next: HTMLDivElement = null\r\n\r\n\tprivate _current: Current = {\r\n\t\tgroup: '',\r\n\t\tindex: -1\r\n\t}\r\n\r\n\tpublic static get default_options(): Options {\r\n\t\treturn {\r\n\t\t\tselector: '.lightbox--link',\r\n\t\t\tlightbox_class: 'lightbox',\r\n\t\t\tlightbox_inner_class: 'lightbox--inner',\r\n\t\t\tlightbox_legend_class: 'lightbox--legend',\r\n\t\t\tlightbox_visible_class: 'visible',\r\n\t\t\timage_loading_class: 'is-loading',\r\n\t\t\tprevent_scroll: true,\r\n\t\t\tprevent_scroll_class: 'prevent-scroll',\r\n\t\t\tprevent_scroll_element: document.body,\r\n\t\t\tinner_offset: 30,\r\n\t\t\tnav: true,\r\n\t\t\tnav_prev_class: 'lightbox--prev',\r\n\t\t\tnav_next_class: 'lightbox--next'\r\n\t\t}\r\n\t}\r\n\r\n\tconstructor(options = {}) {\r\n\t\tthis.options = {\r\n\t\t\t...Lightbox.default_options,\r\n\t\t\t...options\r\n\t\t}\r\n\r\n\t\tthis.elements = document.querySelectorAll(this.options.selector)\r\n\r\n\t\tif (this.elements.length === 0) {\r\n\t\t\tthrow new Error('Lightbox::constructor - no elements found')\r\n\t\t}\r\n\r\n\t\tthis.hide = this.hide.bind(this)\r\n\t\tthis.prev = this.prev.bind(this)\r\n\t\tthis.next = this.next.bind(this)\r\n\t\tthis.onEscape = this.onEscape.bind(this)\r\n\t\tthis.onResize = this.onResize.bind(this)\r\n\r\n\t\tthis.attachEvents()\r\n\t}\r\n\r\n\tpublic show(src: string): void {\r\n\t\tthis._lightbox.classList.add(this.options.image_loading_class)\r\n\r\n\t\tthis._image = new Image()\r\n\r\n\t\tthis._image.onload = async (): Promise<void> => {\r\n\t\t\tawait this.setInnerBoundings()\r\n\r\n\t\t\tthis._lightbox_inner.style.backgroundImage = `url('${this._image.src}')`\r\n\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis._lightbox.classList.remove(this.options.image_loading_class)\r\n\t\t\t}, 300)\r\n\t\t}\r\n\r\n\t\tthis._image.src = src\r\n\r\n\t\tif (this.options.prevent_scroll) {\r\n\t\t\tthis.options.prevent_scroll_element.classList.add(this.options.prevent_scroll_class)\r\n\t\t}\r\n\r\n\t\tthis._lightbox.classList.add(this.options.lightbox_visible_class)\r\n\t}\r\n\r\n\tpublic hide(): this {\r\n\t\tthis._lightbox.classList.remove(this.options.lightbox_visible_class)\r\n\r\n\t\tif (this.options.prevent_scroll) {\r\n\t\t\tthis.options.prevent_scroll_element.classList.remove(this.options.prevent_scroll_class)\r\n\t\t}\r\n\r\n\t\tthis._lightbox_inner.style.backgroundImage = null\r\n\t\tthis._image = null\r\n\r\n\t\tthis.setCurrent()\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tpublic prev(): this {\r\n\t\treturn this.nav(-1)\r\n\t}\r\n\r\n\tpublic next(): this {\r\n\t\treturn this.nav(1)\r\n\t}\r\n\r\n\tpublic destroy(): void {\r\n\t\tfor (let group in this._groups) {\r\n\t\t\tif (this._groups.hasOwnProperty(group)) {\r\n\t\t\t\tconst entries = Object.values(this._groups[group])\r\n\r\n\t\t\t\tif (entries.length > 0) {\r\n\t\t\t\t\tentries.forEach((entry: LightboxListItem): void => {\r\n\t\t\t\t\t\tif (entry.lightbox_inner) {\r\n\t\t\t\t\t\t\tentry.lightbox_inner.removeEventListener('click', (e: MouseEvent) => e.stopPropagation())\r\n\t\t\t\t\t\t\tentry.lightbox_inner.remove()\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tentry.el.removeEventListener('click', entry.event_handler as EventListener)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\twindow.removeEventListener('resize', debounce(this.onResize, 300) as EventListener)\r\n\t\twindow.removeEventListener('keyup', this.onEscape)\r\n\r\n\t\tthis._nav_prev.removeEventListener('click', this.prev)\r\n\t\tthis._nav_next.removeEventListener('click', this.next)\r\n\r\n\t\tthis._lightbox.removeEventListener('click', this.hide)\r\n\t\tthis._lightbox.remove()\r\n\r\n\t\tthis._lightbox = null\r\n\t\tthis._lightbox_inner = null\r\n\t\tthis._image = null\r\n\t\tthis._groups = {}\r\n\t\tthis._nav_prev = null\r\n\t\tthis._nav_next = null\r\n\r\n\t\tthis.setCurrent()\r\n\t}\r\n\r\n\tprivate nav(direction: number): this {\r\n\t\tconst { group, index } = this._current\r\n\t\tconst count = Object.keys(this._groups[group]).length\r\n\t\tconst newIndex = direction < 0\r\n\t\t\t? index - 1 < 0 ? count : index\r\n\t\t\t: index + 1 === count ? -1 : index\r\n\r\n\t\tlet item: LightboxListItem = this._groups[group][newIndex + direction]\r\n\r\n\t\tthis.hide()\r\n\r\n\t\tthis.setCurrent(group, newIndex + direction)\r\n\r\n\t\tthis.show(item.src)\r\n\r\n\t\treturn this\r\n\t}\r\n\r\n\tprivate createLightBox(): void {\r\n\t\tthis._lightbox_inner = document.createElement('div')\r\n\t\tthis._lightbox_inner.classList.add(this.options.lightbox_inner_class)\r\n\r\n\t\tthis._lightbox = document.createElement('div')\r\n\t\tthis._lightbox.classList.add(this.options.lightbox_class)\r\n\t\tthis._lightbox.appendChild(this._lightbox_inner)\r\n\r\n\t\tif (this.options.nav === true) {\r\n\t\t\tconst nav_prev = document.createElement('div')\r\n\t\t\tconst nav_next = document.createElement('div')\r\n\r\n\t\t\tnav_prev.classList.add(this.options.nav_prev_class)\r\n\t\t\tnav_next.classList.add(this.options.nav_next_class)\r\n\r\n\t\t\tnav_prev.addEventListener('click', this.prev)\r\n\t\t\tnav_next.addEventListener('click', this.next)\r\n\r\n\t\t\tthis._lightbox_inner.appendChild(nav_prev)\r\n\t\t\tthis._lightbox_inner.appendChild(nav_next)\r\n\r\n\t\t\tthis._nav_prev = nav_prev\r\n\t\t\tthis._nav_next = nav_next\r\n\t\t}\r\n\r\n\t\tdocument.body.appendChild(this._lightbox)\r\n\t}\r\n\r\n\tprivate attachEvents(): void {\r\n\t\twindow.addEventListener('resize', debounce(this.onResize, 300) as EventListener)\r\n\t\twindow.addEventListener('keyup', this.onEscape)\r\n\r\n\t\tthis.createLightBox()\r\n\r\n\t\tthis.elements.forEach(async (el: HTMLElement): Promise<void> => {\r\n\t\t\tawait this.storeElement(el)\r\n\t\t})\r\n\t}\r\n\r\n\tprivate createLegend(legend: string): void {\r\n\t\tconst div = document.createElement('div')\r\n\r\n\t\tdiv.classList.add(this.options.lightbox_legend_class)\r\n\t\tdiv.innerHTML = legend\r\n\r\n\t\tthis._lightbox_inner.appendChild(div)\r\n\t}\r\n\r\n\tprivate async storeElement(el: HTMLElement): Promise<void> {\r\n\t\tconst src = el.constructor === HTMLImageElement\r\n\t\t\t? (el as HTMLImageElement).src\r\n\t\t\t: el.dataset.src\r\n\r\n\t\tconst group = el.dataset.group || 'default'\r\n\t\t// const legend = el.dataset.legend || null\r\n\r\n\t\tif (!this._groups[group]) {\r\n\t\t\tthis._groups[group] = []\r\n\t\t}\r\n\r\n\t\t/*if (legend !== null) {\r\n\t\t\t\tthis.createLegend(legend)\r\n\t\t}*/\r\n\r\n\t\tthis._lightbox.addEventListener('click', this.hide)\r\n\t\tthis._lightbox_inner.addEventListener('click', (e: MouseEvent) => e.stopPropagation())\r\n\r\n\t\tconst item: LightboxListItem = {\r\n\t\t\tel,\r\n\t\t\tlightbox: this._lightbox,\r\n\t\t\tlightbox_inner: this._lightbox_inner,\r\n\t\t\tsrc\r\n\t\t}\r\n\t\tconst index: number = this._groups[group].push(item) - 1\r\n\r\n\t\tconst event_handler = (): void => {\r\n\t\t\tthis.setCurrent(group, index)\r\n\r\n\t\t\tthis.show(src)\r\n\t\t}\r\n\r\n\t\tthis._groups[group][index].event_handler = event_handler\r\n\r\n\t\tel.addEventListener('click', event_handler as EventListener)\r\n\t}\r\n\r\n\tprivate onEscape(e: KeyboardEvent): void {\r\n\t\tif (e.key === 'Escape') {\r\n\t\t\tthis.hide()\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async onResize(): Promise<void> {\r\n\t\tif (this._image !== null) {\r\n\t\t\tawait this.setInnerBoundings()\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async setInnerBoundings(): Promise<void> {\r\n\t\tconst { naturalWidth, naturalHeight } = this._image\r\n\t\tconst ratio = this.aspectRatioFit(\r\n\t\t\tnaturalWidth,\r\n\t\t\tnaturalHeight,\r\n\t\t\twindow.innerWidth,\r\n\t\t\twindow.innerHeight\r\n\t\t) as AspectRatio\r\n\t\tconst { width, height, orientation } = ratio\r\n\t\tconst { inner_offset } = this.options\r\n\r\n\t\tlet offsetWidth = 0\r\n\t\tlet offsetHeight = 0\r\n\r\n\t\tswitch (orientation) {\r\n\t\t\tcase 'landscape':\r\n\t\t\t\toffsetWidth = inner_offset\r\n\t\t\t\tbreak\r\n\t\t\tcase 'portrait':\r\n\t\t\t\toffsetHeight = inner_offset\r\n\t\t\t\tbreak\r\n\t\t\tcase 'even':\r\n\t\t\t\toffsetWidth = inner_offset\r\n\t\t\t\toffsetHeight = inner_offset\r\n\t\t\t\tbreak\r\n\t\t}\r\n\r\n\t\tthis._lightbox_inner.style.width = `${width - (2 * offsetWidth)}px`\r\n\t\tthis._lightbox_inner.style.height = `${height - (2 * offsetHeight)}px`\r\n\t}\r\n\r\n\tprivate aspectRatioFit(\r\n\t\tsrcWidth: number,\r\n\t\tsrcHeight: number,\r\n\t\tmaxWidth: number,\r\n\t\tmaxHeight: number\r\n\t): AspectRatio {\r\n\t\tlet ratio = Math.min(maxWidth / srcWidth, maxHeight / srcHeight)\r\n\t\tlet orientation = 'even'\r\n\r\n\t\tif (srcWidth > srcHeight) {\r\n\t\t\torientation = 'landscape'\r\n\t\t} else if (srcWidth < srcHeight) {\r\n\t\t\torientation = 'portrait'\r\n\t\t}\r\n\r\n\t\tlet width = srcWidth * ratio\r\n\t\tlet height = srcHeight * ratio\r\n\r\n\t\tif (width <= maxWidth || height <= maxHeight) {\r\n\t\t\torientation = 'even'\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tratio,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\torientation\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setCurrent(\r\n\t\tgroup: string = '',\r\n\t\tindex: number = -1\r\n\t): void {\r\n\t\tthis._current.group = group\r\n\t\tthis._current.index = index\r\n\t}\r\n}\r\n\r\nif (window && document) {\r\n\twindow['Lightbox'] = Lightbox\r\n}\r\n","import Lightbox from \"./src/Lightbox\"\r\n\r\nglobalThis.Lightbox = Lightbox"]}